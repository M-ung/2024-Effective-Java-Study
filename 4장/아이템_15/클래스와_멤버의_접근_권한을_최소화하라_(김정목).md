# 클래스와 멤버의 접근 권한을 최소화하라.

</br>

"클래스와 멤버의 접근권한을 최소화하라"는 원칙은 정보 은닉(Encapsulation)과 관련된 개념으로, 코드를 작성할 때 클래스와 그 내부 멤버에 대한 접근 권한을 가능한 한 제한하는 것을 권장하는 원칙이다. 이렇게 함으로써 코드의 유지 보수성과 안정성을 높일 수 있다. <br>

## 📌 정보 은닉의 장점
1️⃣ 시스템 개발 속도를 높인다. <br>
2️⃣ 시스템 관리 비용을 낮춘다. <br>
3️⃣ 정보 은닉 자체가 성능을 높여주지는 않지만, 성능 최적화에 도움을 준다. <br>
4️⃣ 소프트웨어 재사용성을 높인다. <br>
5️⃣ 큰 시스템을 제작하는 난이도를 낮춰준다. <br>
<br>
정보 은닉의 기본 원칙은 간단하다. 모든 클래스와 멤버의 접근성을 가능한 좁혀야 한다. <br>

<br>

## 📌 멤버에 부여할 수 있는 접근 수준
1️⃣ `private` : 멤버를 선언한 톱레벨 클래스에서만 접근할 수 있다. <br>
2️⃣ `package-private` : 멤버가 소속된 패키지 안의 모든 클래스에서 접근할 수 있다. <br>
3️⃣ `protected` : package-private의 접근 범위를 포함하며, 이 멤버를 선언한 클래스의 하위 클래스에서도 접근할 수 있다. <br>
4️⃣ `public` : 모든 곳에서 접근할 수 있다. <br>

<br>

## 📌 접근 제어자 관리 방법
- 공개할 API를 세심히 설계한 후 그 외의 모든 멤버는 `private`으로 설정한다.
- 다른 클래스가 접근해야 하는 멤버에 한해 `package-private`으로 풀어줄 수 있다.
- 권한을 풀어줘야 하는 일이 잦다면, 다른 클래스가 하나 더 만들어져야 하는 것은 아닌지 생각해보자.
- `private`과 `package-private` 멤버는 모두 해당 클래스 내부 구현에 해당하므로 공개 API에 영향을 주지 않는다.
- 만일 `private`, `package-private` 외에 `protected`로 풀어준다면, 그 멤버는 API로서 계속 제공되어야 하기 때문에 신중해야 한다.
  -  이러한 이유로 `protected`, `public`의 수는 정말 최소화해야 한다.
- `Serialize` 인터페이스를 구현하게 되면, 필드들이 의도치 않게 공개 API가 될 수 있으므로 주의해야 한다.

<br>

## 📌 테스트를 위해 접근 범위를 넓히지 않도록 주의하라
- 테스트를 위해 필드를 `public`으로 만들지 마라
  - 테스트 코드를 테스트 대상과 같은 패키지에 두면 `package-private` 요소에 접근 가능하다.
 
<br>

## 📌 정보 은닉을 위한 클래스 설계 시 몇 가지 주의점
- `public` 클래스의 인스턴스 필드는 되도록 `public`이 아니어야 한다.
  - `public` 가변 필드를 갖는 클래스는 일반적으로 `thread-safe`하지 않다.
- `public` 접근자인데 필드가 final이며, 불변 객체를 참조한다고 해서 안심하면 안된다.
  - 리팩토링할 때 이미 이 클래스를 다른 클래스가 사용중이라면 `public` 필드는 함부로 없애지 못한다는 사실을 인지하자.
- 배열은 `public final`로 제공하더라도, 배열 내용을 변경할 수 있음에 유의하자.
  - `public static final Thing[] VALUES = { ... };`
    - 사용자는 이 배열의 내용을 변경할 수 있다.
- 배열을 `public`으로 공개하고 싶다면, 아래 코드처럼 작성하면 된다.

<br>

```java
private static final Thing[] VALUES = { ... };
public static final List<Thing> VALUES = // 사용자는 값 확인이 가능하다.
  Collections.unmodifiableList(Arrays.asList(PRIVATE_VALUES));
public static final Thing[] values() { // 사용자는 값의 복사본 객체를 받을 수 있다.
  return PRIVATE_VALUES.clone(); // 배열을 복사할 때는 `clone()`이 유용하다.
}
```
값의 확인을 원하는지, 복사를 원하는지에 본인이 원하는 상황에 따라 위의 코드처럼 구현하면 될 것이다. <br>

## ⭐️ 핵심 정리
- 접근제한자는 가능한 최소로 주자. <br>
- 꼭 필요한 것만 골라 최소한의 `public API`를 설계하는 편이 좋다. <br>
- 멤버가 의도치 않게 API로 공개되는 일이 없도록 하자. <br>
- `public` 클래스는 상수용 `public static final` 필드 외에 어떠한 `public` 필드도 가져선 안된다. <br>
- `public static final` 필드가 참조하는 객체가 불변인지 확인하라. <br>
